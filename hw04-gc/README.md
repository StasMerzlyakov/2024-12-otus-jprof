# Параметры машины

```bash
free
              всего        занято        свободно      общая  буф./врем.   доступно
Память:    16258488     5107408     6953672     1198140     4197408     9603148
Подкачка:    38571004      116224    38454780

```

Свобоно 6Gb, тестировать буту в пределах от 256mb до 4gb

```bash
uname -a
Linux stsm 5.4.0-204-generic #224-Ubuntu SMP Thu Dec 5 13:38:28 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux
```

```bash
cat /proc/cpuinfo 
processor	: 0 .. 5    <-- 6 ядер
vendor_id	: GenuineIntel
cpu family	: 6
model		: 158
model name	: Intel(R) Core(TM) i5-8400 CPU @ 2.80GHz
```

```bash
java -version
openjdk version "21.0.5" 2024-10-15
OpenJDK Runtime Environment (build 21.0.5+11-Ubuntu-1ubuntu120.04)
OpenJDK 64-Bit Server VM (build 21.0.5+11-Ubuntu-1ubuntu120.04, mixed mode, sharing)
```

# Ход работ

## Результаты тестирвоания исходного класса ru.calculator.CalcDemo с различыми размерами хипа
heap(mgb)  time(sec)
256	109
512	108
768	108
1024	106
1280	108
1536	104
1792	104
2048	104
2304	106
2560	107
2816	104
3072	104
3328	105
3584	102
3840	104
4096	103


Небольшое улучшение производительности на границе в 2GB, далее особых улучшений не видно

## Результат оптимизации 1 
- замена Integer на int в сумматоре

Heap(mgb)	Время(сек)
256	76
512	76
768	76
1024	75
1280	76
1536	75
1792	73
2048	74
2304	74
2560	74
2816	73
3072	73
3328	73
3584	73
3840	73
4096	73

Результат оптимизации - приложение стало быстрее на 30%, значение изменение heap на таком фоне не существенно


## Результат оптимизации 2 
- замена Integer на int в сумматоре 
- переиспользование структуры Data

Heap(mgb)	Время(сек)
256	78
512	78
768	77
1024	77
1280	76
1536	76
1792	73
2048	76
2304	73
2560	72
2816	73
3072	72
3328	72
3584	70
3840	72
4096	71

Результат оптимизации - чуть суть быстрее варинта 1.

## Оптимизация 3:
- замена Integer на int в сумматоре
- переиспользование структуры Data
- замена Integer в Data на int

Heap(mgb)	Время(сек)
256	74
512	73
768	74
1024	74
1280	73
1536	71
1792	72
2048	72
2304	70
2560	70
2816	70
3072	70
3328	70
3584	70
3840	71
4096	69

Результат оптимизации - чуть суть быстрее варианта 2.


## Оптимизация 4:
- замена Integer на int в сумматоре
- переиспользование структуры Data
- замена Integer в Data на int
- сразу выделяется память в ArrayList

Heap(mgb)	Время(сек)
256	75
512	75
768	74
1024	73
1280	73
1536	72
1792	72
2048	72
2304	70
2560	69
2816	69
3072	69
3328	69
3584	69
3840	70
4096	70


Результат оптимизации - чуть суть быстрее варианта 3. В директории logs остались логи gc от предыдущих запусков, что интересно - была итерация, в которой gc не вызывался ни разу.


